<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <title>츼rea do Aluno</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      type="module"
      src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"
    ></script>
    <script
      nomodule
      src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"
    ></script>
  </head>
  <body class="flex bg-black min-h-screen">
    <!-- Sidebar -->
    <aside
      id="sidebar"
      class="w-64 bg-[#2e2e30] text-white flex flex-col py-8 px-4 space-y-6 transition-all duration-300"
    >
      <button
        id="toggleSidebar"
        class="text-3xl flex items-center justify-center mb-8 focus:outline-none"
      >
        <ion-icon name="menu-outline"></ion-icon>
      </button>
      <nav class="space-y-4">
        <a
          href="#"
          id="menu-pagina-inicial"
          class="flex items-center space-x-2 hover:text-yellow-400"
        >
          <ion-icon name="home-outline"></ion-icon>
          <span class="menu-text">P치gina inicial</span>
        </a>
        <a
          href="#"
          id="menu-painel-estudos"
          class="flex items-center space-x-2 hover:text-yellow-400"
        >
          <ion-icon name="book-outline"></ion-icon>
          <span class="menu-text">Painel de estudos</span>
        </a>
        <a
          href="#"
          class="flex items-center space-x-2 hover:text-yellow-400"
        >
          <ion-icon name="notifications-outline"></ion-icon>
          <span class="menu-text">Caixa de entrada</span>
        </a>
      </nav>
    </aside>

    <!-- Main content -->
    <main class="flex-1 p-8 text-center text-white">
      <!-- Conte칰do da P치gina Inicial -->
      <div id="pagina-inicial">
        <p id="dataAtual" class="text-lg mb-2"></p>
        <h1 class="text-3xl font-bold mb-8">游냣 Bem vindo(a), {{nome_usuario}}!</h1>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 justify-center items-start">
          <!-- M칩dulo I -->
          <div
            class="bg-yellow-400 text-black p-6 rounded-3xl shadow-lg flex flex-col items-center"
          >
            <h2 class="text-xl font-bold underline mb-4">M칍DULO I</h2>
            <ul class="text-left space-y-1 mb-4">
              <li>introdu칞칚o  algoritmos;</li>
              <li>operadores;</li>
              <li>condicional;</li>
              <li>repeti칞칚o;</li>
            </ul>
            <ul class="text-left list-disc pl-5">
              <li>material te칩rico</li>
              <li>exerc칤cios</li>
            </ul>
          </div>

          <!-- M칩dulo II -->
          <div
            class="bg-yellow-400 text-black p-6 rounded-3xl shadow-lg flex flex-col items-center"
          >
            <h2 class="text-xl font-bold underline mb-4">M칍DULO II</h2>
            <ul class="text-left space-y-1 mb-4">
              <li>vetores;</li>
              <li>strings;</li>
              <li>manipula칞칚o de strings;</li>
              <li>matrizes;</li>
            </ul>
            <ul class="text-left list-disc pl-5">
              <li>material te칩rico</li>
              <li>exerc칤cios</li>
            </ul>
          </div>

          <!-- M칩dulo III -->
          <div
            class="bg-yellow-400 text-black p-6 rounded-3xl shadow-lg flex flex-col items-center"
          >
            <h2 class="text-xl font-bold underline mb-4">M칍DULO III</h2>
            <ul class="text-left space-y-1 mb-4">
              <li>fun칞칫es;</li>
              <li>struct;</li>
              <li>ponteiros;</li>
              <li>depura칞칚o;</li>
            </ul>
            <ul class="text-left list-disc pl-5">
              <li>material te칩rico</li>
              <li>exerc칤cios</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Painel de Estudos (inicialmente escondido) -->
      <div
        id="painel-estudos"
        class="hidden mt-12 bg-gray-800 p-6 rounded-3xl shadow-lg text-left"
      >
        <h2 class="text-2xl font-bold mb-4 text-yellow-400">
          Painel de Estudos (Tarefas)
        </h2>

        <div class="flex mb-4">
          <input
            id="novaTarefa"
            type="text"
            placeholder="Adicionar nova tarefa..."
            class="flex-1 px-4 py-2 rounded-l-md text-black focus:outline-none"
          />
          <button
            onclick="adicionarTarefa()"
            class="bg-yellow-400 text-black px-4 py-2 rounded-r-md font-bold hover:bg-yellow-300"
          >
            Adicionar
          </button>
        </div>

        <ul id="listaTarefas" class="space-y-2"></ul>
      </div>
    </main>

    <script>
      const API_URL = "http://localhost:8080/tarefas";

      async function carregarTarefas() {
        const res = await fetch(API_URL);
        const tarefas = await res.json();
        renderizarTarefas(tarefas);
      }

      async function adicionarTarefa() {
        const input = document.getElementById("novaTarefa");
        const texto = input.value.trim();
        if (!texto) return;

        await fetch(API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ texto }),
        });

        input.value = "";
        carregarTarefas();
      }

      function renderizarTarefas(tarefas) {
        const lista = document.getElementById("listaTarefas");
        lista.innerHTML = "";

        tarefas.forEach((tarefa) => {
          const li = document.createElement("li");
          li.className = `flex justify-between items-center p-3 rounded-md ${
            tarefa.concluida ? "bg-green-500 line-through" : "bg-gray-700"
          }`;

          const span = document.createElement("span");
          span.textContent = tarefa.texto;

          const divBtns = document.createElement("div");
          divBtns.className = "space-x-2";

          // Agora todas as tarefas podem ser editadas e deletadas
          const btnConcluir = document.createElement("button");
          btnConcluir.textContent = tarefa.concluida ? "Desfazer" : "Concluir";
          btnConcluir.className =
            "bg-green-400 text-black px-2 py-1 rounded hover:bg-green-300";
          btnConcluir.onclick = async () => {
            await fetch(
              `${API_URL}/${tarefa.id}/${tarefa.concluida ? "desfazer" : "concluir"}`,
              { method: "PATCH" }
            );
            carregarTarefas();
          };

          const btnEditar = document.createElement("button");
          btnEditar.textContent = "Editar";
          btnEditar.className =
            "bg-yellow-400 text-black px-2 py-1 rounded hover:bg-yellow-300";
          btnEditar.onclick = async () => {
            const novoTexto = prompt("Editar tarefa:", tarefa.texto);
            if (novoTexto && novoTexto.trim() !== "") {
              await fetch(`${API_URL}/${tarefa.id}`, {
                method: "PUT",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ texto: novoTexto }),
              });
              carregarTarefas();
            }
          };

          const btnDeletar = document.createElement("button");
          btnDeletar.textContent = "Deletar";
          btnDeletar.className =
            "bg-red-500 text-white px-2 py-1 rounded hover:bg-red-400";
          btnDeletar.onclick = async () => {
            await fetch(`${API_URL}/${tarefa.id}`, { method: "DELETE" });
            carregarTarefas();
          };

          divBtns.appendChild(btnConcluir);
          divBtns.appendChild(btnEditar);
          divBtns.appendChild(btnDeletar);

          li.appendChild(span);
          li.appendChild(divBtns);

          lista.appendChild(li);
        });
      }

      // Atualiza a data
      const dataEl = document.getElementById("dataAtual");
      const hoje = new Date();
      const options = { weekday: "long", day: "numeric", month: "long" };
      const dataFormatada = hoje.toLocaleDateString("pt-BR", options);
      dataEl.textContent =
        dataFormatada.charAt(0).toUpperCase() + dataFormatada.slice(1);

      // Toggle sidebar
      document
        .getElementById("toggleSidebar")
        .addEventListener("click", function () {
          const sidebar = document.getElementById("sidebar");
          sidebar.classList.toggle("w-64");
          sidebar.classList.toggle("w-16");

          const texts = sidebar.querySelectorAll(".menu-text");
          texts.forEach((text) => {
            text.classList.toggle("hidden");
          });
        });

      // Controle para mostrar/esconder p치ginas
      const menuInicial = document.getElementById("menu-pagina-inicial");
      const menuPainel = document.getElementById("menu-painel-estudos");
      const paginaInicial = document.getElementById("pagina-inicial");
      const painelEstudos = document.getElementById("painel-estudos");

      menuPainel.addEventListener("click", (e) => {
        e.preventDefault();
        paginaInicial.classList.add("hidden");
        painelEstudos.classList.remove("hidden");
        carregarTarefas();
      });

      menuInicial.addEventListener("click", (e) => {
        e.preventDefault();
        painelEstudos.classList.add("hidden");
        paginaInicial.classList.remove("hidden");
      });
    </script>
  </body>
</html>
